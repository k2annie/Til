# 1-1. BigQuery 기초 지식

## [다룰 내용]
- 데이터 관련 기초 지식(OLTP, SQL, Row, Column, 저장 형태 등)
- BigQuery 관련 기초 지식(왜 사용하는지, 장점, 비용)
- BigQuery 환경 설정

### 1. 데이터 저장 형태
- 데이터베이스(DB) 테이블 등에 저장
  - DB: 데이터의 저장소
  - Table: 데이터가 저장된 공간
  - 저장된 데이터를 제품(앱, 웹)에서 사용

DB 속에 Table(T1, T2, T3...) 등이 추출.

- 데이터가 저장되는 장소: MySQL, Oracle, PostgreSQL 등의 DB
- 회사마다 사용하는 DB에 차이가 있음.

#### 1) MySQL, Oracle, PostgreSQL 같은 DB의 특징 => OLTP
OLTP(Online Transaction Processing)
- 거래를 위한 DB
- 보류, 중간 상태가 없음(애매X): 데이터 무결성(주문 완료/주문 X)
- 데이터의 추가(INSERT), 데이터의 변경(UPDATE)이 많이 발생
  - 예시: 음식 준비 -> 배달 중 -> 배달 완료
- SQL을 사용해서 데이터 추출이 가능하나, 쿼리 속도가 느릴 수 있음.

#### 2) SQL(Structured Query Language)
- SQL: DB에서 데이터를 가지고 올 때 사용하는 언어, DB의 데이터를 관리하기 위해 설계된 특수 목적의 프로그래밍 언어.
- SQL을 짠다 == 쿼리문을 작성한다.  / SQL and Query

#### 테이블 구조: Column & Row
- 행(Row): 하나의 row가 하나의 고유한 데이터(속성을 묶은 개념)
  - *Raw 데이터 == 원본 데이터
- 열(Column): 각 데이터의 특정 속성 값

OLTP로 데이터를 분류하다가 데이터 크기가 커지면 속도, 기능 이슈 발생
=> OLAP(Online Analytical Processing) 등장 (분석용).

### 데이터 웨어하우스(창고)
- 데이터를 한 곳에 모아 저장
- DB, 웹(크롤링), 파일, API의 결과 등

## 2. BigQuery(구글 클라우드의 데이터 웨어하우스)

1. 난이도: 쉬움
2. 속도: OLAP 도구이므로 속도가 빠름
3. Firebase, Google Analytics 4(앱 개발 및 앱 관련 고객 정보)의 데이터를 쉽게 추출 가능
   - 예시: 사용 기기, 위치, OS 버전, 이벤트 행동 획득 가능(별도의 로깅 필요)
4. 데이터 웨어하우스 사용을 위한 서버(컴퓨터)를 띄울 필요 없음
   - 구글에서 인프라 관리
   - 예시: AWS EC2 같은 서버를 띄울 필요 없음
   - 운영을 적은 비용(인력 등)으로 진행 가능

## 3. BigQuery 비용 (US 기준)
- **쿼리 비용**: SQL 쿼리를 실행해서 데이터 탐색할 때 발생하는 비용
  - On-demand 요금제(쿼리 처리 용량만큼 부과) + Capacity 요금제(Slot)
- **저장 비용**: 데이터를 저장하는 용량마다 비용 부과
  - Active Logical 저장소 / Long-term Logical 저장소

---

# 1-2. BigQuery 환경 설정

## Google Cloud 가입
- Google Cloud 프로젝트 생성
- Google Cloud BigQuery Activate 및 테이블 로드

**ID**: inflearn-bigquery-435811

### 1. BigQuery 환경 구성 요소
1) **프로젝트(Project)**: 하나의 큰 건물
   - 하나의 프로젝트에 여러 데이터셋이 존재할 수 있음

2) **데이터셋(Dataset)**: 프로젝트에 있는 창고. 각 창고 공간에 데이터 저장. 예시: 판매/고객 데이터 등 별도의 데이터를 저장 가능
   - 하나의 데이터셋에 다양한 테이블이 존재할 수 있음

3) **테이블(Table)**: 창고에 있는 선반
   - 테이블 안에 상품의 세부 정보가 저장
   - 테이블 안에는 행과 열로 이뤄진 데이터들이 저장됨

### 2. 구글 클라우드 설정 - 생성된 테이블 확인

파티션(가림막)을 설정한 Table(Battle) vs 나머지

SQL 쿼리 초안 프로토타입:
```sql
SELECT FROM `inflearn-bigquery-435811.basic.pokemon` LIMIT 1000
```

# 2-1. 데이터 활용 Overview

## [다룰 내용]
- 포켓몬으로 이해하는 SQL
- 데이터 탐색: 조건과 추출
- SQL의 기본 문법
  - SELECT
  - FROM
  - WHERE
- 데이터 탐색: 요약하기(GROUP BY..)

### 1. 데이터 활용 과정
1) **task** 존재 -> 문제를 정의해야 함.
2) 문제 정의 과정에서 원하는 것을 정해야 함.
   - MECE(문제정의)가 정말 중요. So what, why so
   - 고객, 타깃.. 원하는 것이 있다면 **지표 정의(metric)**이 중요.
3) 원하는 것이 떠오른 뒤에는 **데이터를 탐색**해야 함.
   - 데이터: 단일 자료/다량의 자료 (여러 개의 데이터를 볼 때는 이를 연결하는 작업이 필요하다.)
   - 조건(필터링)/추출/변환/요약

- 가설과 데이터 탐색 과정이 왔다 갔다 반복됨.

4) **데이터 결과 검증**: '예상 == 실제' 확인 (중요!)
5) 피드백/활용

---

# 2-2. 저장된 데이터 확인하기 (데이터베이스, 데이터 웨어하우스, ERD)

## [SQL 쿼리를 작성하기 전에]
- 데이터가 어떻게 저장되어 있는지
- 어떤 데이터가 저장되어 있는지
- 컬럼의 의미가 무엇인지

=> 데이터를 제대로 이해해야 올바른 데이터를 추출할 수 있기 때문에 구체적인 정의를 항상 확인하면서 쿼리를 작성해야 한다.

**예시**: 물품 창고에서 배송할 때를 생각해보자.
카테고리와 카테고리의 위치.
- 데이터 웨어하우스(창고) - 테이블(선반) - 데이터(상자)
  
### 데이터 추출 전 확인 사항:
1. 데이터가 저장되는 형태를 알려면?
   - **ERD(Entity Relationship Diagram)**: DB 구조를 한눈에 알아보기 위해 사용

#### 1-1. 만약 ERD가 없다면?
- 모든 DB를 직접 보면서 탐색!
  - 어떤 테이블이 존재하는지
  - 어떤 컬럼이 존재하는지 (row 갯수)
  - 다른 테이블과 연결할 때 어떤 컬럼을 사용하는지
    - (product_id, customer_id) -> [order]
  - 컬럼의 값들이 어떤 의미를 가지는지
    - ex) order_status

- 스프레드시트/문서 등으로 따로 정리!

### 1-2. 회사에서의 데이터 예시
1) 서비스에 사용될 DB (가장 유력. 없을 수가 없죠!)
   - user/things/delivery
2) 앱/웹 로그 데이터
   - 유저가 앱/웹에 들어와서 무엇을 하는지 등의 데이터 -> **'과정'**을 알 수 있음.
3) 공공 데이터, 서드파티 데이터
   - 날씨/페이스북 광고 데이터 등

### 1-3. 포켓몬 세상을 데이터로 생각해보자!

1) 데이터 종류
   - 포켓몬
   - 트레이너
   - 트레이너가 잡은 포켓몬
   - 배틀
   - NPC
   - 상점
   - 상점 판매 제품

2) 이커머스 산업과의 데이터 연관성
   - 포켓몬: 상품
   - 트레이너: 유저
   - 트레이너가 잡은 포켓몬: 주문
   - 장바구니에 담은 물건
   - 웹페이지 접근 수
   - 웹페이지의 버튼 클릭 수

